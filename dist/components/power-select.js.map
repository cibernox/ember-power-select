{"version":3,"file":"power-select.js","sources":["../../src/components/power-select.gts"],"sourcesContent":["import Component from '@glimmer/component';\nimport { tracked } from '@glimmer/tracking';\nimport { action, get } from '@ember/object';\nimport { guidFor } from '@ember/object/internals';\nimport isEqual from '../utils/equal.ts';\nimport { assert } from '@ember/debug';\nimport {\n  indexOfOption,\n  filterOptions,\n  findOptionWithOffset,\n  countOptions,\n  defaultHighlighted,\n  advanceSelectableOption,\n  defaultMatcher,\n  defaultTypeAheadMatcher,\n  pathForOption,\n} from '../utils/group-utils.ts';\nimport { task, timeout } from 'ember-concurrency';\nimport { modifier } from 'ember-modifier';\nimport PowerSelectLabelComponent from './power-select/label.gts';\nimport PowerSelectTriggerComponent from './power-select/trigger.gts';\nimport PowerSelectPlaceholderComponent from './power-select/placeholder.gts';\nimport PowerSelectBeforeOptionsComponent from './power-select/before-options.gts';\nimport SearchMessageComponent from './power-select/search-message.gts';\nimport NoMatchesMessageComponent from './power-select/no-matches-message.gts';\nimport PowerSelectOptionsComponent from './power-select/options.gts';\nimport PowerSelectGroupComponent from './power-select/power-select-group.gts';\nimport type { BasicDropdownDefaultBlock } from 'ember-basic-dropdown/components/basic-dropdown';\nimport type { Dropdown, TRootEventType } from 'ember-basic-dropdown/types';\nimport type Owner from '@ember/owner';\nimport type {\n  CalculatePosition,\n  HorizontalPosition,\n  VerticalPosition,\n} from 'ember-basic-dropdown/utils/calculate-position';\nimport type { ComponentLike } from '@glint/template';\nimport type { PowerSelectPlaceholderSignature } from './power-select/placeholder.gts';\nimport type { PowerSelectSearchMessageSignature } from './power-select/search-message.gts';\nimport type { PowerSelectNoMatchesMessageSignature } from './power-select/no-matches-message.gts';\nimport type { BasicDropdownTriggerSignature } from 'ember-basic-dropdown/components/basic-dropdown-trigger';\nimport type { BasicDropdownContentSignature } from 'ember-basic-dropdown/components/basic-dropdown-content';\nimport type { PowerSelectLabelSignature } from './power-select/label.gts';\nimport type { PowerSelectTriggerSignature } from './power-select/trigger.gts';\nimport type { PowerSelectBeforeOptionsSignature } from './power-select/before-options.gts';\nimport type { PowerSelectOptionsSignature } from './power-select/options.gts';\nimport type { PowerSelectPowerSelectGroupSignature } from './power-select/power-select-group.gts';\nimport type {\n  DefaultHighlightedParams,\n  MatcherFn,\n  Option,\n  PowerSelectAfterOptionsSignature,\n  PowerSelectSelectedItemSignature,\n  Select,\n  Selected,\n  TLabelClickAction,\n  TSearchFieldPosition,\n} from '../types.ts';\nimport BasicDropdown from 'ember-basic-dropdown/components/basic-dropdown';\nimport { on } from '@ember/modifier';\nimport { or, and, not, notEq } from 'ember-truth-helpers';\nimport { concat } from '@ember/helper';\n\ninterface PromiseProxy<T = unknown> extends Promise<T> {\n  content: T;\n}\n\ninterface CancellablePromise<T> extends Promise<T> {\n  cancel: () => void;\n}\n\ninterface Sliceable<T> {\n  slice(): T[];\n}\n\n// Some args are not listed here because they are only accessed from the template. Should I list them?\nexport interface PowerSelectArgs<\n  T,\n  IsMultiple extends boolean = false,\n  TExtra = unknown,\n> {\n  highlightOnHover?: boolean;\n  placeholderComponent?: ComponentLike<\n    PowerSelectPlaceholderSignature<T, TExtra, IsMultiple>\n  >;\n  searchMessage?: string;\n  searchMessageComponent?: ComponentLike<\n    PowerSelectSearchMessageSignature<T, TExtra, IsMultiple>\n  >;\n  noMatchesMessage?: string;\n  noMatchesMessageComponent?: ComponentLike<\n    PowerSelectNoMatchesMessageSignature<T, TExtra, IsMultiple>\n  >;\n  matchTriggerWidth?: boolean;\n  resultCountMessage?: (resultCount: number) => string;\n  options?: readonly T[] | Promise<readonly T[]>;\n  selected?: Selected<T, IsMultiple> | Promise<Selected<T, IsMultiple>>;\n  multiple?: IsMultiple;\n  destination?: string;\n  destinationElement?: HTMLElement;\n  closeOnSelect?: boolean;\n  renderInPlace?: boolean;\n  preventScroll?: boolean;\n  defaultHighlighted?:\n    | ((params: DefaultHighlightedParams<T>) => Option<T> | undefined)\n    | Option<T>\n    | undefined;\n  searchField?: string;\n  labelClass?: string;\n  labelText?: string;\n  labelTag?: keyof HTMLElementTagNameMap;\n  labelClickAction?: TLabelClickAction;\n  ariaLabel?: string;\n  ariaLabelledBy?: string;\n  loadingMessage?: string;\n  placeholder?: string;\n  dropdownClass?: string;\n  allowClear?: boolean;\n  searchEnabled?: boolean;\n  animationEnabled?: boolean;\n  tabindex?: number | string;\n  searchPlaceholder?: string;\n  searchFieldPosition?: TSearchFieldPosition;\n  verticalPosition?: VerticalPosition;\n  horizontalPosition?: HorizontalPosition;\n  triggerId?: string;\n  disabled?: boolean;\n  title?: string;\n  triggerRole?: string;\n  required?: string;\n  triggerClass?: string;\n  ariaInvalid?: string;\n  eventType?: BasicDropdownTriggerSignature['Args']['eventType'];\n  rootEventType?: TRootEventType;\n  ariaDescribedBy?: string;\n  calculatePosition?: CalculatePosition;\n  ebdTriggerComponent?: ComponentLike<BasicDropdownTriggerSignature>;\n  ebdContentComponent?: ComponentLike<BasicDropdownContentSignature>;\n  labelComponent?: ComponentLike<\n    PowerSelectLabelSignature<T, TExtra, IsMultiple>\n  >;\n  triggerComponent?: ComponentLike<\n    PowerSelectTriggerSignature<T, TExtra, IsMultiple>\n  >;\n  selectedItemComponent?: ComponentLike<\n    PowerSelectSelectedItemSignature<T, TExtra, IsMultiple>\n  >;\n  beforeOptionsComponent?: ComponentLike<\n    PowerSelectBeforeOptionsSignature<T, TExtra, IsMultiple>\n  >;\n  optionsComponent?: ComponentLike<\n    PowerSelectOptionsSignature<T, TExtra, IsMultiple>\n  >;\n  groupComponent?: ComponentLike<\n    PowerSelectPowerSelectGroupSignature<T, TExtra, IsMultiple>\n  >;\n  afterOptionsComponent?: ComponentLike<\n    PowerSelectAfterOptionsSignature<T, TExtra, IsMultiple>\n  >;\n  extra?: TExtra;\n  matcher?: MatcherFn<T>;\n  initiallyOpened?: boolean;\n  typeAheadOptionMatcher?: MatcherFn<T>;\n  buildSelection?: (\n    selected: Option<T>,\n    select: Select<T, IsMultiple>,\n  ) => Selected<T, IsMultiple>;\n  onChange: (\n    selection: Selected<T, IsMultiple>,\n    select: Select<T, IsMultiple>,\n    event?: Event,\n  ) => void;\n  search?: (\n    term: string,\n    select: Select<T, IsMultiple>,\n  ) => readonly T[] | Promise<readonly T[]>;\n  onOpen?: (\n    select: Select<T, IsMultiple>,\n    e: Event | undefined,\n  ) => boolean | void | undefined;\n  onClose?: (\n    select: Select<T, IsMultiple>,\n    e: Event | undefined,\n  ) => boolean | void | undefined;\n  onInput?: (\n    term: string,\n    select: Select<T, IsMultiple>,\n    e: Event,\n  ) => string | boolean | void;\n  onKeydown?: (\n    select: Select<T, IsMultiple>,\n    e: KeyboardEvent,\n  ) => boolean | void | undefined;\n  onFocus?: (select: Select<T, IsMultiple>, event: FocusEvent) => void;\n  onBlur?: (select: Select<T, IsMultiple>, event: FocusEvent) => void;\n  scrollTo?: (option: Selected<T>, select: Select<T, IsMultiple>) => void;\n  registerAPI?: (select: Select<T, IsMultiple>) => void;\n}\n\nexport interface PowerSelectSignature<\n  T,\n  IsMultiple extends boolean = false,\n  TExtra = undefined,\n> {\n  Element: Element;\n  Args: PowerSelectArgs<T, IsMultiple, TExtra>;\n  Blocks: {\n    default: [option: Option<T>, select: Select<T, IsMultiple>];\n  };\n}\n\nconst isSliceable = <T,>(coll: unknown): coll is Sliceable<T> => {\n  return Array.isArray(coll);\n};\n\nconst isPromiseLike = <T,>(thing: unknown): thing is Promise<T> => {\n  return (\n    typeof thing === 'object' &&\n    thing !== null &&\n    typeof (thing as { then?: unknown }).then === 'function'\n  );\n};\n\nconst isCancellablePromise = <T,>(\n  thing: unknown,\n): thing is CancellablePromise<T> => {\n  return (\n    typeof thing === 'object' &&\n    thing !== null &&\n    typeof (thing as { cancel?: unknown }).cancel === 'function'\n  );\n};\n\nconst toPlainArray = <T,>(collection: T | T[] | Sliceable<T>): T[] | T => {\n  if (isSliceable<T>(collection)) {\n    return collection.slice();\n  } else {\n    return collection;\n  }\n};\n\nfunction getOptionMatcher<T>(\n  matcher: MatcherFn<T>,\n  defaultMatcher: MatcherFn<T>,\n  searchField: string | undefined,\n): MatcherFn<T> {\n  if (searchField && matcher === defaultMatcher) {\n    return (option: T | undefined, text: string) =>\n      matcher(get(option, searchField) as T | undefined, text);\n  } else {\n    return (option: T | undefined, text: string) => {\n      assert(\n        '<PowerSelect> If you want the default filtering to work on options that are not plain strings, you need to provide `@searchField`',\n        matcher !== defaultMatcher || typeof option === 'string',\n      );\n      return matcher(option, text);\n    };\n  }\n}\n\nexport default class PowerSelectComponent<\n  T,\n  IsMultiple extends boolean = false,\n  TExtra = undefined,\n> extends Component<PowerSelectSignature<T, IsMultiple, TExtra>> {\n  // Untracked properties\n  _publicAPIActions = {\n    search: this._search.bind(this),\n    highlight: this._highlight.bind(this),\n    select: this._select.bind(this),\n    choose: this._choose.bind(this),\n    scrollTo: this._scrollTo.bind(this),\n    labelClick: this._labelClick.bind(this),\n  };\n\n  // Tracked properties\n  @tracked private _resolvedOptions?: T | readonly T[];\n  @tracked private _resolvedSelected?: Selected<T, IsMultiple> | undefined;\n  @tracked private _repeatingChar = '';\n  @tracked private _expirableSearchText = '';\n  @tracked private _searchResult?: readonly T[];\n  @tracked isActive = false;\n  @tracked loading = false;\n  @tracked searchText = '';\n  @tracked lastSearchedText = '';\n  @tracked highlighted?: Option<T> | undefined;\n  storedAPI!: Select<T, IsMultiple>;\n\n  private _uid = guidFor(this);\n  private _lastOptionsPromise?: Promise<readonly T[]>;\n  private _lastSelectedPromise?:\n    | PromiseProxy<Selected<T, IsMultiple>>\n    | Promise<Selected<T, IsMultiple>>;\n  private _lastSearchPromise?:\n    | Promise<readonly T[]>\n    | CancellablePromise<readonly T[]>;\n  private _filterResultsCache: {\n    results: T[];\n    options: T[];\n    searchText: string;\n  } = { results: [], options: [], searchText: this.searchText };\n\n  // Lifecycle hooks\n  constructor(owner: Owner, args: PowerSelectArgs<T, IsMultiple, TExtra>) {\n    super(owner, args);\n    assert(\n      '<PowerSelect> requires an `@onChange` function',\n      this.args.onChange && typeof this.args.onChange === 'function',\n    );\n  }\n\n  willDestroy() {\n    super.willDestroy();\n  }\n\n  // Getters\n  get highlightOnHover(): boolean {\n    return this.args.highlightOnHover === undefined\n      ? true\n      : this.args.highlightOnHover;\n  }\n\n  get labelClickAction(): TLabelClickAction {\n    return this.args.labelClickAction === undefined\n      ? 'focus'\n      : this.args.labelClickAction;\n  }\n\n  get highlightedIndex(): string {\n    const results = this.results;\n    const highlighted = this.highlighted;\n    return pathForOption(results, highlighted);\n  }\n\n  get searchMessage(): string {\n    return this.args.searchMessage === undefined\n      ? 'Type to search'\n      : this.args.searchMessage;\n  }\n\n  get noMatchesMessage(): string {\n    return this.args.noMatchesMessage === undefined\n      ? 'No results found'\n      : this.args.noMatchesMessage;\n  }\n\n  get resultCountMessage(): string {\n    if (typeof this.args.resultCountMessage === 'function') {\n      return this.args.resultCountMessage(this.resultsCount);\n    }\n\n    if (this.resultsCount === 1) {\n      return `${this.resultsCount} result`;\n    }\n\n    return `${this.resultsCount} results`;\n  }\n\n  get matchTriggerWidth() {\n    return this.args.matchTriggerWidth === undefined\n      ? true\n      : this.args.matchTriggerWidth;\n  }\n\n  get mustShowSearchMessage(): boolean {\n    return (\n      !this.loading &&\n      this.searchText.length === 0 &&\n      !!this.args.search &&\n      !!this.searchMessage &&\n      this.resultsCount === 0\n    );\n  }\n\n  get mustShowNoMessages(): boolean {\n    return (\n      !this.loading &&\n      this.resultsCount === 0 &&\n      (!this.args.search || this.lastSearchedText.length > 0)\n    );\n  }\n\n  get results(): T[] {\n    if (this.searchText.length > 0) {\n      if (this.args.search) {\n        return toPlainArray(this._searchResult || this.options) as T[];\n      } else {\n        if (\n          this._filterResultsCache.options === this.options &&\n          this._filterResultsCache.searchText === this.searchText\n        ) {\n          // This is an optimization to avoid filtering several times, which may be a bit expensive\n          // if there are many options, if neither the options nor the searchtext have changed\n          return this._filterResultsCache.results;\n        }\n        const results = this._filter(this.options, this.searchText);\n        // eslint-disable-next-line ember/no-side-effects\n        this._filterResultsCache = {\n          results,\n          options: this.options,\n          searchText: this.searchText,\n        };\n        return results;\n      }\n    } else {\n      return this.options;\n    }\n  }\n\n  get options(): T[] {\n    if (this._resolvedOptions) {\n      return toPlainArray(this._resolvedOptions) as T[];\n    }\n    if (this.args.options) {\n      return toPlainArray(this.args.options as T[]) as T[];\n    } else {\n      return [];\n    }\n  }\n\n  get resultsCount(): number {\n    return countOptions(this.results);\n  }\n\n  get selected(): Selected<T, IsMultiple> | undefined {\n    if (this._resolvedSelected) {\n      return toPlainArray(this._resolvedSelected) as Selected<T, IsMultiple>;\n    } else if (\n      this.args.selected !== undefined &&\n      this.args.selected !== null &&\n      !isPromiseLike(this.args.selected)\n    ) {\n      return toPlainArray(this.args.selected) as Selected<T, IsMultiple>;\n    }\n    return undefined;\n  }\n\n  get ariaMultiSelectable(): boolean {\n    return Array.isArray(this.args.selected);\n  }\n\n  get triggerId(): string {\n    return this.args.triggerId || `${this._uid}-trigger`;\n  }\n\n  get labelId(): string {\n    return `${this._uid}-label`;\n  }\n\n  get ariaLabelledBy(): string | undefined {\n    if (this.args.ariaLabelledBy) {\n      return this.args.ariaLabelledBy;\n    }\n\n    if (this.args.labelText || this.args.labelComponent) {\n      return this.labelId;\n    }\n  }\n\n  get searchFieldPosition(): TSearchFieldPosition {\n    if (this.args.searchFieldPosition !== undefined) {\n      return this.args.searchFieldPosition;\n    }\n\n    if (this.args.multiple) {\n      return 'trigger';\n    }\n\n    return 'before-options';\n  }\n\n  get tabindex(): string | number {\n    if (this.args.multiple) {\n      if (this.args.triggerComponent === undefined && this.args.searchEnabled) {\n        return '-1';\n      } else {\n        return this.args.tabindex || '0';\n      }\n    }\n\n    if (\n      this.args.searchEnabled &&\n      this.args.tabindex === undefined &&\n      this.searchFieldPosition === 'trigger'\n    ) {\n      return '-1';\n    }\n\n    return this.args.tabindex || '0';\n  }\n\n  get buildSelection(): PowerSelectArgs<\n    T,\n    IsMultiple,\n    TExtra\n  >['buildSelection'] {\n    if (this.args.buildSelection) {\n      return this.args.buildSelection;\n    }\n\n    if (this.args.multiple) {\n      return this._defaultMultipleBuildSelection.bind(this);\n    }\n  }\n\n  get labelComponent(): ComponentLike<\n    PowerSelectLabelSignature<T, TExtra, IsMultiple>\n  > {\n    if (this.args.labelComponent) {\n      return this.args.labelComponent;\n    }\n\n    return PowerSelectLabelComponent as ComponentLike<\n      PowerSelectLabelSignature<T, TExtra, IsMultiple>\n    >;\n  }\n\n  get triggerComponent(): ComponentLike<\n    PowerSelectTriggerSignature<T, TExtra, IsMultiple>\n  > {\n    if (this.args.triggerComponent) {\n      return this.args.triggerComponent;\n    }\n\n    return PowerSelectTriggerComponent as ComponentLike<\n      PowerSelectTriggerSignature<T, TExtra, IsMultiple>\n    >;\n  }\n\n  get placeholderComponent(): ComponentLike<\n    PowerSelectPlaceholderSignature<T, TExtra, IsMultiple>\n  > {\n    if (this.args.placeholderComponent) {\n      return this.args.placeholderComponent;\n    }\n\n    return PowerSelectPlaceholderComponent as ComponentLike<\n      PowerSelectPlaceholderSignature<T, TExtra, IsMultiple>\n    >;\n  }\n\n  get beforeOptionsComponent(): ComponentLike<\n    PowerSelectBeforeOptionsSignature<T, TExtra, IsMultiple>\n  > {\n    if (this.args.beforeOptionsComponent) {\n      return this.args.beforeOptionsComponent;\n    }\n\n    return PowerSelectBeforeOptionsComponent as ComponentLike<\n      PowerSelectBeforeOptionsSignature<T, TExtra, IsMultiple>\n    >;\n  }\n\n  get searchMessageComponent(): ComponentLike<\n    PowerSelectSearchMessageSignature<T, TExtra, IsMultiple>\n  > {\n    if (this.args.searchMessageComponent) {\n      return this.args.searchMessageComponent;\n    }\n\n    return SearchMessageComponent as ComponentLike<\n      PowerSelectSearchMessageSignature<T, TExtra, IsMultiple>\n    >;\n  }\n\n  get noMatchesMessageComponent(): ComponentLike<\n    PowerSelectNoMatchesMessageSignature<T, TExtra, IsMultiple>\n  > {\n    if (this.args.noMatchesMessageComponent) {\n      return this.args.noMatchesMessageComponent;\n    }\n\n    return NoMatchesMessageComponent as ComponentLike<\n      PowerSelectNoMatchesMessageSignature<T, TExtra, IsMultiple>\n    >;\n  }\n\n  get optionsComponent(): ComponentLike<\n    PowerSelectOptionsSignature<T, TExtra, IsMultiple>\n  > {\n    if (this.args.optionsComponent) {\n      return this.args.optionsComponent;\n    }\n\n    return PowerSelectOptionsComponent as ComponentLike<\n      PowerSelectOptionsSignature<T, TExtra, IsMultiple>\n    >;\n  }\n\n  get groupComponent(): ComponentLike<\n    PowerSelectPowerSelectGroupSignature<T, TExtra, IsMultiple>\n  > {\n    if (this.args.groupComponent) {\n      return this.args.groupComponent;\n    }\n\n    return PowerSelectGroupComponent as ComponentLike<\n      PowerSelectPowerSelectGroupSignature<T, TExtra, IsMultiple>\n    >;\n  }\n\n  // Actions\n  @action\n  handleOpen(_select: Dropdown, e: Event | undefined): boolean | void {\n    if (this.args.onOpen && this.args.onOpen(this.storedAPI, e) === false) {\n      return false;\n    }\n\n    this.focusInput(this.storedAPI);\n\n    if (e) {\n      if (\n        e instanceof KeyboardEvent &&\n        e.type === 'keydown' &&\n        (e.key === 'ArrowUp' || e.key === 'ArrowDown')\n      ) {\n        e.preventDefault();\n      }\n    }\n    this._resetHighlighted();\n  }\n\n  @action\n  handleClose(_select: Dropdown, e: Event | undefined): boolean | void {\n    if (this.args.onClose && this.args.onClose(this.storedAPI, e) === false) {\n      return false;\n    }\n    this._highlight(undefined);\n  }\n\n  @action\n  handleInput(e: InputEvent): void {\n    if (e.target === null) return;\n    const term = (e.target as HTMLInputElement).value;\n    let correctedTerm;\n    if (this.args.onInput) {\n      correctedTerm = this.args.onInput(term, this.storedAPI, e);\n      if (correctedTerm === false) {\n        return;\n      }\n    }\n    this._publicAPIActions.search(\n      typeof correctedTerm === 'string' ? correctedTerm : term,\n    );\n  }\n\n  @action\n  handleKeydown(e: KeyboardEvent): boolean | void {\n    if (\n      this.args.onKeydown &&\n      this.args.onKeydown(this.storedAPI, e) === false\n    ) {\n      return false;\n    }\n\n    if (this.args.multiple && e.key === 'Enter' && this.storedAPI.isOpen) {\n      e.stopPropagation();\n      if (this.storedAPI.highlighted !== undefined) {\n        if (\n          !Array.isArray(this.storedAPI.selected) ||\n          this.storedAPI.selected.indexOf(this.storedAPI.highlighted) === -1\n        ) {\n          this.storedAPI.actions.choose(this.storedAPI.highlighted, e);\n          return false;\n        } else {\n          this.storedAPI.actions.close(e);\n          return false;\n        }\n      } else {\n        this.storedAPI.actions.close(e);\n        return false;\n      }\n    }\n\n    if (\n      this.searchFieldPosition === 'trigger' &&\n      !this.storedAPI.isOpen &&\n      e.key !== 'Tab' && // TAB\n      e.key !== 'Enter' && // ENTER\n      e.key !== 'Escape' // ESC\n    ) {\n      this.storedAPI.actions.open(e);\n    }\n    return this._routeKeydown(this.storedAPI, e);\n  }\n\n  @action\n  handleTriggerKeydown(e: KeyboardEvent) {\n    if (\n      this.args.onKeydown &&\n      this.args.onKeydown(this.storedAPI, e) === false\n    ) {\n      e.stopImmediatePropagation();\n      return;\n    }\n    if (e.ctrlKey || e.metaKey) {\n      e.stopImmediatePropagation();\n      return;\n    }\n    if (e.key.length === 1 && /^[a-z0-9]$/i.test(e.key)) {\n      // Keys 0-9, a-z or numpad keys\n      void this.triggerTypingTask.perform(e);\n    } else if (e.key === ' ') {\n      // Space\n      this._handleKeySpace(this.storedAPI, e);\n    } else {\n      return this._routeKeydown(this.storedAPI, e);\n    }\n  }\n\n  @action\n  _labelClick(event: MouseEvent) {\n    if (!this.storedAPI) {\n      return;\n    }\n\n    // Double-click, do nothing\n    if (event.detail > 1) {\n      return;\n    }\n\n    if (this.labelClickAction === 'open') {\n      this.storedAPI.actions.open();\n      return;\n    } else if (this.labelClickAction === 'focus') {\n      const trigger = this.storedAPI.actions.getTriggerElement();\n\n      if (!trigger) {\n        return;\n      }\n\n      trigger.focus();\n    }\n\n    return true;\n  }\n\n  @action\n  handleFocus(event: FocusEvent): void {\n    if (!this.isDestroying) {\n      void Promise.resolve().then(() => {\n        this._updateIsActive(true);\n      });\n    }\n    if (this.searchFieldPosition === 'trigger') {\n      if (event.target) {\n        const target = event.target as HTMLElement;\n        const input = target.querySelector<HTMLInputElement>(\n          'input[type=\"search\"]',\n        );\n        input?.focus();\n      }\n    }\n    if (this.args.onFocus) {\n      this.args.onFocus(this.storedAPI, event);\n    }\n  }\n\n  @action\n  handleBlur(event: FocusEvent): void {\n    if (!this.isDestroying) {\n      void Promise.resolve().then(() => {\n        this._updateIsActive(false);\n      });\n    }\n    if (this.args.onBlur) {\n      this.args.onBlur(this.storedAPI, event);\n    }\n  }\n\n  // Methods\n  @action\n  _search(term: string): void {\n    if (this.searchText === term) return;\n    this.searchText = term;\n    if (!this.args.search) {\n      this.lastSearchedText = term;\n      this._resetHighlighted();\n    }\n  }\n\n  @action\n  _updateHighlighted(): void {\n    if (this.storedAPI.isOpen) {\n      this._resetHighlighted();\n    }\n  }\n\n  @action\n  _highlight(opt: Option<T> | undefined): void {\n    if (opt && typeof opt === 'object' && 'disabled' in opt && opt.disabled) {\n      return;\n    }\n    this.highlighted = opt;\n  }\n\n  @action\n  _select(selected: Selected<T, IsMultiple>, e?: Event): void {\n    if (!isEqual(this.storedAPI.selected, selected)) {\n      this.args.onChange(selected, this.storedAPI, e);\n    }\n  }\n\n  @action\n  _choose(selected: Option<T>, e?: Event): void {\n    const buildSelection = this.buildSelection;\n    const selection = buildSelection\n      ? buildSelection(selected, this.storedAPI)\n      : selected;\n    this.storedAPI.actions.select(selection as Selected<T, IsMultiple>, e);\n    if (this.args.closeOnSelect !== false) {\n      this.storedAPI.actions.close(e);\n      if (this.searchFieldPosition === 'trigger') {\n        this.searchText = '';\n      }\n      // return false;\n    }\n  }\n\n  @action\n  _scrollTo(option: Selected<T>): void {\n    const select = this.storedAPI;\n    if (!document || !option) {\n      return;\n    }\n    if (this.args.scrollTo) {\n      return this.args.scrollTo(option, select);\n    }\n\n    let root: Document | HTMLElement;\n\n    const triggerElement = select.actions.getTriggerElement();\n    if (triggerElement && triggerElement.getRootNode() instanceof ShadowRoot) {\n      root = triggerElement.getRootNode() as HTMLElement;\n    } else {\n      root = document;\n    }\n\n    const optionsList = root.querySelector(\n      `#ember-power-select-options-${select.uniqueId}`,\n    ) as HTMLElement;\n    if (!optionsList) {\n      return;\n    }\n    const index = indexOfOption(select.results, option);\n    if (index === -1) {\n      return;\n    }\n    const optionElement = optionsList.querySelector(\n      `[data-option-index='${index}']`,\n    ) as HTMLElement;\n    if (!optionElement) {\n      return;\n    }\n    const optionTopScroll = optionElement.offsetTop - optionsList.offsetTop;\n    const optionBottomScroll = optionTopScroll + optionElement.offsetHeight;\n    if (optionBottomScroll > optionsList.offsetHeight + optionsList.scrollTop) {\n      optionsList.scrollTop = optionBottomScroll - optionsList.offsetHeight;\n    } else if (optionTopScroll < optionsList.scrollTop) {\n      optionsList.scrollTop = optionTopScroll;\n    }\n  }\n\n  updateOptions = modifier(\n    () => {\n      this.__updateOptions();\n    },\n    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n    // @ts-ignore\n    { eager: false },\n  );\n\n  updateSelected = modifier(\n    () => {\n      this.__updateSelected();\n    },\n    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n    // @ts-ignore\n    { eager: false },\n  );\n\n  updateRegisterAPI = modifier(\n    (triggerElement: Element, [publicAPI]: [Select<T, IsMultiple>]) => {\n      this.__registerAPI(triggerElement, [publicAPI]);\n    },\n    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n    // @ts-ignore\n    { eager: false },\n  );\n\n  updatePerformSearch = modifier(\n    (triggerElement: Element, [term]: [string]) => {\n      this.__performSearch(triggerElement, [term]);\n    },\n    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n    // @ts-ignore\n    { eager: false },\n  );\n\n  private __updateOptions() {\n    if (!this.args.options) return;\n    if (isPromiseLike(this.args.options)) {\n      if (this._lastOptionsPromise === this.args.options) return; // promise is still the same\n      const currentOptionsPromise = this.args.options;\n      this._lastOptionsPromise = currentOptionsPromise;\n      this.loading = true;\n      this._lastOptionsPromise\n        .then((resolvedOptions) => {\n          if (this._lastOptionsPromise === currentOptionsPromise) {\n            this.loading = false;\n            this._resolvedOptions = resolvedOptions;\n            this._resetHighlighted();\n          }\n        })\n        .catch(() => {\n          if (this._lastOptionsPromise === currentOptionsPromise) {\n            this.loading = false;\n          }\n        });\n    } else {\n      void Promise.resolve().then(() => {\n        this._resetHighlighted();\n      });\n    }\n  }\n\n  private __updateSelected(): void {\n    if (this.args.selected === undefined || this.args.selected === null) return;\n    if (isPromiseLike(this.args.selected)) {\n      if (this._lastSelectedPromise === this.args.selected) return; // promise is still the same\n      const currentSelectedPromise = this.args.selected;\n      this._lastSelectedPromise = currentSelectedPromise;\n      void this._lastSelectedPromise.then((resolvedSelected) => {\n        if (this._lastSelectedPromise === currentSelectedPromise) {\n          this._resolvedSelected = resolvedSelected;\n          if (!Array.isArray(resolvedSelected)) {\n            this._highlight(resolvedSelected as Option<T>);\n          }\n        }\n      });\n    } else {\n      this._resolvedSelected = undefined;\n      // Don't highlight args.selected array on multi-select\n      if (!Array.isArray(this.args.selected)) {\n        this._highlight(this.args.selected as Option<T>);\n      }\n    }\n  }\n\n  private __registerAPI(\n    _: Element,\n    [publicAPI]: [Select<T, IsMultiple>],\n  ): void {\n    this.storedAPI = publicAPI;\n    if (this.args.registerAPI) {\n      void Promise.resolve().then(() => {\n        if (this.args.registerAPI) {\n          this.args.registerAPI(publicAPI);\n        }\n      });\n    }\n  }\n\n  private __performSearch(_: Element, [term]: [string]): void {\n    if (!this.args.search) return;\n    if (term === '') {\n      this.loading = false;\n      this.lastSearchedText = term;\n      if (this._lastSearchPromise !== undefined) {\n        if (isCancellablePromise(this._lastSearchPromise)) {\n          this._lastSearchPromise.cancel(); // Cancel ember-concurrency tasks\n        }\n        this._lastSearchPromise = undefined;\n      }\n      return;\n    }\n    const searchResult = this.args.search(term, this.storedAPI);\n    if (searchResult && isPromiseLike(searchResult)) {\n      this.loading = true;\n      if (\n        this._lastSearchPromise !== undefined &&\n        isCancellablePromise(this._lastSearchPromise)\n      ) {\n        this._lastSearchPromise.cancel(); // Cancel ember-concurrency tasks\n      }\n      this._lastSearchPromise = searchResult;\n      searchResult\n        .then((results) => {\n          if (this._lastSearchPromise === searchResult) {\n            this._searchResult = results;\n            this.loading = false;\n            this.lastSearchedText = term;\n            void Promise.resolve().then(() => {\n              this._resetHighlighted();\n            });\n          }\n        })\n        .catch(() => {\n          if (this._lastSearchPromise === searchResult) {\n            this.loading = false;\n            this.lastSearchedText = term;\n          }\n        });\n    } else {\n      this.lastSearchedText = term;\n      this._searchResult = searchResult;\n      void Promise.resolve().then(() => {\n        this._resetHighlighted();\n      });\n    }\n  }\n\n  @action\n  private _defaultMultipleBuildSelection(\n    selected: Option<T>,\n    select: Select<T, IsMultiple>,\n  ): Selected<T, IsMultiple> {\n    if (!this.args.multiple) {\n      throw new Error('The defaultBuildSelection is only allowed for multiple');\n    }\n\n    const newSelection: Option<T>[] = Array.isArray(select.selected)\n      ? (select.selected as Option<T>[]).slice(0)\n      : [];\n    let idx = -1;\n    for (let i = 0; i < newSelection.length; i++) {\n      if (isEqual(newSelection[i], selected)) {\n        idx = i;\n        break;\n      }\n    }\n    if (idx > -1) {\n      newSelection.splice(idx, 1);\n    } else {\n      newSelection.push(selected);\n    }\n\n    return newSelection as Selected<T, IsMultiple>;\n  }\n\n  focusInput(select: Select<T, IsMultiple>) {\n    if (select) {\n      const input = document.querySelector(\n        `#ember-power-select-trigger-input-${select.uniqueId}`,\n      ) as HTMLElement;\n      if (input) {\n        input.focus();\n      }\n    }\n  }\n\n  _routeKeydown(\n    select: Select<T, IsMultiple>,\n    e: KeyboardEvent,\n  ): boolean | void {\n    if (e.key === 'ArrowUp' || e.key === 'ArrowDown') {\n      // Up & Down\n      return this._handleKeyUpDown(select, e);\n    } else if (e.key === 'Enter') {\n      // ENTER\n      return this._handleKeyEnter(select, e);\n    } else if (e.key === 'Tab') {\n      // Tab\n      return this._handleKeyTab(select, e);\n    } else if (e.key === 'Escape') {\n      // ESC\n      return this._handleKeyESC(select, e);\n    }\n  }\n\n  _handleKeyTab(select: Select<T, IsMultiple>, e: KeyboardEvent): void {\n    select.actions.close(e);\n  }\n\n  _handleKeyESC(select: Select<T, IsMultiple>, e: KeyboardEvent): void {\n    select.actions.close(e);\n  }\n\n  _handleKeyEnter(\n    select: Select<T, IsMultiple>,\n    e: KeyboardEvent,\n  ): boolean | void {\n    if (select.isOpen && select.highlighted !== undefined) {\n      select.actions.choose(select.highlighted, e);\n      e.stopImmediatePropagation();\n      return false;\n    }\n  }\n\n  _handleKeySpace(select: Select<T, IsMultiple>, e: KeyboardEvent): void {\n    if (\n      e.target !== null &&\n      ['TEXTAREA', 'INPUT'].includes((e.target as Element).nodeName)\n    ) {\n      e.stopImmediatePropagation();\n    } else if (select.isOpen && select.highlighted !== undefined) {\n      e.stopImmediatePropagation();\n      e.preventDefault(); // Prevents scrolling of the page.\n      select.actions.choose(select.highlighted, e);\n    }\n  }\n\n  _handleKeyUpDown(select: Select<T, IsMultiple>, e: KeyboardEvent): void {\n    if (select.isOpen) {\n      e.preventDefault();\n      e.stopPropagation();\n      const step: 1 | -1 = e.key === 'ArrowDown' ? 1 : -1;\n      const newHighlighted = advanceSelectableOption(\n        select.results,\n        select.highlighted,\n        step,\n      );\n      select.actions.highlight(newHighlighted);\n      select.actions.scrollTo(newHighlighted);\n    } else {\n      select.actions.open(e);\n    }\n  }\n\n  _resetHighlighted(): void {\n    let highlighted: Option<T> | undefined;\n    const defHighlighted = this.args.defaultHighlighted || defaultHighlighted;\n    if (typeof defHighlighted === 'function') {\n      highlighted = (defHighlighted as typeof defaultHighlighted)({\n        results: this.results,\n        highlighted: this.highlighted,\n        selected: this.selected,\n      });\n    } else {\n      highlighted = defHighlighted;\n    }\n    this._highlight(highlighted);\n  }\n\n  _filter(options: T[], term: string, skipDisabled = false): T[] {\n    const matcher = this.args.matcher || defaultMatcher;\n    const optionMatcher = getOptionMatcher(\n      matcher as MatcherFn<T>,\n      defaultMatcher as MatcherFn<T>,\n      this.args.searchField,\n    );\n    return filterOptions(options || [], term, optionMatcher, skipDisabled);\n  }\n\n  _updateIsActive(value: boolean) {\n    this.isActive = value;\n  }\n\n  findWithOffset(\n    options: readonly T[],\n    term: string,\n    offset: number,\n    skipDisabled = false,\n  ): Option<T> | undefined {\n    const typeAheadOptionMatcher = getOptionMatcher(\n      this.args.typeAheadOptionMatcher ||\n        (defaultTypeAheadMatcher as MatcherFn<T>),\n      defaultTypeAheadMatcher as MatcherFn<T>,\n      this.args.searchField,\n    );\n    return findOptionWithOffset(\n      options || [],\n      term,\n      typeAheadOptionMatcher,\n      offset,\n      skipDisabled,\n    );\n  }\n\n  publicAPI = (dropdown: BasicDropdownDefaultBlock): Select<T, IsMultiple> => {\n    return Object.assign({}, dropdown, {\n      selected: this.selected,\n      multiple: this.args.multiple ?? false,\n      highlighted: this.highlighted,\n      options: this.options,\n      results: this.results,\n      resultsCount: this.resultsCount,\n      loading: this.loading,\n      isActive: this.isActive,\n      searchText: this.searchText,\n      lastSearchedText: this.lastSearchedText,\n      actions: Object.assign({}, dropdown.actions, this._publicAPIActions),\n    }) as Select<T, IsMultiple>;\n  };\n\n  // Tasks\n  triggerTypingTask = task({ restartable: true }, async (e: KeyboardEvent) => {\n    // In general, a user doing this interaction means to have a different result.\n    let searchStartOffset = 1;\n    let repeatingChar = this._repeatingChar;\n    let term;\n\n    // Check if user intends to cycle through results. _repeatingChar can only be the first character.\n    const c = e.key.length === 1 ? e.key : '';\n    if (c === this._repeatingChar) {\n      term = c;\n    } else {\n      term = this._expirableSearchText + c;\n    }\n\n    if (term.length > 1) {\n      // If the term is longer than one char, the user is in the middle of a non-cycling interaction\n      // so the offset is just zero (the current selection is a valid match).\n      searchStartOffset = 0;\n      repeatingChar = '';\n    } else {\n      repeatingChar = c;\n    }\n\n    // When the select is open, the \"selection\" is just highlighted.\n    if (this.storedAPI.isOpen && this.storedAPI.highlighted) {\n      searchStartOffset += indexOfOption(\n        this.storedAPI.options,\n        this.storedAPI.highlighted,\n      );\n    } else if (\n      !this.storedAPI.isOpen &&\n      this.selected !== undefined &&\n      this.selected !== null\n    ) {\n      searchStartOffset += indexOfOption(this.storedAPI.options, this.selected);\n    } else {\n      searchStartOffset = 0;\n    }\n\n    // The char is always appended. That way, searching for words like \"Aaron\" will work even\n    // if \"Aa\" would cycle through the results.\n    this._expirableSearchText = this._expirableSearchText + c;\n    this._repeatingChar = repeatingChar;\n    const match = this.findWithOffset(\n      this.storedAPI.options,\n      term,\n      searchStartOffset,\n      true,\n    );\n    if (match !== undefined) {\n      if (this.storedAPI.isOpen) {\n        this.storedAPI.actions.highlight(match);\n        this.storedAPI.actions.scrollTo(match);\n      } else {\n        let selected: Option<T> | Option<T>[] = match;\n        if (this.args.multiple) {\n          selected = [match];\n        }\n\n        this.storedAPI.actions.select(selected as Selected<T, IsMultiple>, e);\n      }\n    }\n    await timeout(1000);\n    this._expirableSearchText = '';\n    this._repeatingChar = '';\n  });\n\n  <template>\n    {{#if (or @labelText @labelComponent)}}\n      <this.labelComponent\n        @select={{this.storedAPI}}\n        @labelText={{@labelText}}\n        @labelId={{this.labelId}}\n        @triggerId={{this.triggerId}}\n        @labelTag={{@labelTag}}\n        @extra={{@extra}}\n        class={{@labelClass}}\n      />\n    {{/if}}\n    <BasicDropdown\n      @horizontalPosition={{@horizontalPosition}}\n      @destinationElement={{@destinationElement}}\n      @destination={{@destination}}\n      @initiallyOpened={{@initiallyOpened}}\n      @matchTriggerWidth={{this.matchTriggerWidth}}\n      @preventScroll={{or @preventScroll false}}\n      @onClose={{this.handleClose}}\n      @onOpen={{this.handleOpen}}\n      @renderInPlace={{@renderInPlace}}\n      @verticalPosition={{@verticalPosition}}\n      @disabled={{@disabled}}\n      @calculatePosition={{@calculatePosition}}\n      @triggerComponent={{@ebdTriggerComponent}}\n      @contentComponent={{@ebdContentComponent}}\n      @rootEventType={{or @rootEventType \"mousedown\"}}\n      as |dropdown|\n    >\n      {{#let\n        (this.publicAPI dropdown)\n        (concat \"ember-power-select-options-\" dropdown.uniqueId)\n        as |publicAPI listboxId|\n      }}\n        {{! template-lint-disable no-positive-tabindex }}\n        <dropdown.Trigger\n          @eventType={{or @eventType \"mousedown\"}}\n          {{this.updateOptions @options}}\n          {{this.updateSelected @selected}}\n          {{this.updateRegisterAPI publicAPI}}\n          {{this.updatePerformSearch this.searchText}}\n          {{on \"keydown\" this.handleTriggerKeydown}}\n          {{on \"focus\" this.handleFocus}}\n          {{on \"blur\" this.handleBlur}}\n          class=\"ember-power-select-trigger\n            {{if @multiple ' ember-power-select-multiple-trigger'}}\n            {{@triggerClass}}{{if\n              publicAPI.isActive\n              ' ember-power-select-trigger--active'\n            }}\"\n          aria-activedescendant={{if\n            dropdown.isOpen\n            (unless\n              @searchEnabled\n              (concat publicAPI.uniqueId \"-\" this.highlightedIndex)\n            )\n          }}\n          aria-controls={{if\n            (and dropdown.isOpen (not @searchEnabled))\n            listboxId\n          }}\n          aria-describedby={{@ariaDescribedBy}}\n          aria-haspopup={{unless @searchEnabled \"listbox\"}}\n          aria-invalid={{@ariaInvalid}}\n          aria-label={{@ariaLabel}}\n          aria-labelledby={{this.ariaLabelledBy}}\n          aria-owns={{if (and dropdown.isOpen (not @searchEnabled)) listboxId}}\n          aria-required={{@required}}\n          aria-autocomplete={{if @searchEnabled \"list\"}}\n          role={{or @triggerRole \"combobox\"}}\n          title={{@title}}\n          id={{this.triggerId}}\n          tabindex={{and (not @disabled) (or this.tabindex \"0\")}}\n          ...attributes\n        >\n          <this.triggerComponent\n            @allowClear={{@allowClear}}\n            @buildSelection={{this.buildSelection}}\n            @loadingMessage={{or @loadingMessage \"Loading options...\"}}\n            @selectedItemComponent={{@selectedItemComponent}}\n            @select={{publicAPI}}\n            @searchEnabled={{@searchEnabled}}\n            @searchField={{@searchField}}\n            @searchFieldPosition={{this.searchFieldPosition}}\n            @onFocus={{this.handleFocus}}\n            @onBlur={{this.handleBlur}}\n            @extra={{@extra}}\n            @listboxId={{listboxId}}\n            @onInput={{this.handleInput}}\n            @onKeydown={{this.handleKeydown}}\n            @placeholder={{@placeholder}}\n            @searchPlaceholder={{@searchPlaceholder}}\n            @placeholderComponent={{this.placeholderComponent}}\n            @ariaActiveDescendant={{concat\n              publicAPI.uniqueId\n              \"-\"\n              this.highlightedIndex\n            }}\n            @ariaLabelledBy={{this.ariaLabelledBy}}\n            @ariaDescribedBy={{@ariaDescribedBy}}\n            @ariaLabel={{@ariaLabel}}\n            @role={{@triggerRole}}\n            @tabindex={{@tabindex}}\n            as |opt select|\n          >\n            {{yield opt select}}\n          </this.triggerComponent>\n        </dropdown.Trigger>\n        <dropdown.Content\n          class=\"ember-power-select-dropdown{{if\n              publicAPI.isActive\n              ' ember-power-select-dropdown--active'\n            }}\n            {{@dropdownClass}}\"\n          @animationEnabled={{@animationEnabled}}\n        >\n          {{#if (notEq @beforeOptionsComponent null)}}\n            <this.beforeOptionsComponent\n              @select={{publicAPI}}\n              @searchEnabled={{@searchEnabled}}\n              @onInput={{this.handleInput}}\n              @onKeydown={{this.handleKeydown}}\n              @onFocus={{this.handleFocus}}\n              @onBlur={{this.handleBlur}}\n              @placeholder={{@placeholder}}\n              @placeholderComponent={{this.placeholderComponent}}\n              @extra={{@extra}}\n              @listboxId={{listboxId}}\n              @ariaActiveDescendant={{if\n                this.highlightedIndex\n                (concat publicAPI.uniqueId \"-\" this.highlightedIndex)\n              }}\n              @selectedItemComponent={{@selectedItemComponent}}\n              @searchPlaceholder={{@searchPlaceholder}}\n              @searchFieldPosition={{this.searchFieldPosition}}\n              @ariaLabel={{@ariaLabel}}\n              @ariaLabelledBy={{this.ariaLabelledBy}}\n              @ariaDescribedBy={{@ariaDescribedBy}}\n              @triggerRole={{@triggerRole}}\n            />\n          {{/if}}\n          {{#if this.mustShowSearchMessage}}\n            <this.searchMessageComponent\n              @searchMessage={{this.searchMessage}}\n              @select={{publicAPI}}\n              @extra={{@extra}}\n              id={{listboxId}}\n              aria-label={{@ariaLabel}}\n              aria-labelledby={{this.ariaLabelledBy}}\n            />\n          {{else if this.mustShowNoMessages}}\n            <this.noMatchesMessageComponent\n              @noMatchesMessage={{this.noMatchesMessage}}\n              @select={{publicAPI}}\n              @extra={{@extra}}\n              id={{listboxId}}\n              aria-label={{@ariaLabel}}\n              aria-labelledby={{this.ariaLabelledBy}}\n            />\n          {{else}}\n            <this.optionsComponent\n              @loadingMessage={{or @loadingMessage \"Loading options...\"}}\n              @select={{publicAPI}}\n              @options={{publicAPI.results}}\n              @groupIndex=\"\"\n              @optionsComponent={{this.optionsComponent}}\n              @extra={{@extra}}\n              @highlightOnHover={{this.highlightOnHover}}\n              @groupComponent={{this.groupComponent}}\n              role=\"listbox\"\n              aria-multiselectable={{if this.ariaMultiSelectable \"true\"}}\n              id={{listboxId}}\n              class=\"ember-power-select-options\"\n              as |option select|\n            >\n              {{yield option select}}\n            </this.optionsComponent>\n          {{/if}}\n\n          {{#if @afterOptionsComponent}}\n            {{#let @afterOptionsComponent as |AfterOptions|}}\n              <AfterOptions @extra={{@extra}} @select={{publicAPI}} />\n            {{/let}}\n          {{/if}}\n          <div\n            role=\"status\"\n            aria-live=\"polite\"\n            aria-atomic=\"true\"\n            class=\"ember-power-select-visually-hidden\"\n          >\n            {{this.resultCountMessage}}\n          </div>\n        </dropdown.Content>\n      {{/let}}\n    </BasicDropdown>\n  </template>\n}\n"],"names":["isSliceable","coll","Array","isArray","isPromiseLike","thing","then","isCancellablePromise","cancel","toPlainArray","collection","slice","getOptionMatcher","matcher","defaultMatcher","searchField","option","text","get","assert","PowerSelectComponent","Component","_publicAPIActions","search","_search","bind","highlight","_highlight","select","_select","choose","_choose","scrollTo","_scrollTo","labelClick","_labelClick","g","prototype","tracked","i","storedAPI","_uid","guidFor","_lastOptionsPromise","_lastSelectedPromise","_lastSearchPromise","_filterResultsCache","results","options","searchText","constructor","owner","args","onChange","willDestroy","highlightOnHover","undefined","labelClickAction","highlightedIndex","highlighted","pathForOption","searchMessage","noMatchesMessage","resultCountMessage","resultsCount","matchTriggerWidth","mustShowSearchMessage","loading","length","mustShowNoMessages","lastSearchedText","_searchResult","_filter","_resolvedOptions","countOptions","selected","_resolvedSelected","ariaMultiSelectable","triggerId","labelId","ariaLabelledBy","labelText","labelComponent","searchFieldPosition","multiple","tabindex","triggerComponent","searchEnabled","buildSelection","_defaultMultipleBuildSelection","PowerSelectLabelComponent","PowerSelectTriggerComponent","placeholderComponent","PowerSelectPlaceholderComponent","beforeOptionsComponent","PowerSelectBeforeOptionsComponent","searchMessageComponent","SearchMessageComponent","noMatchesMessageComponent","NoMatchesMessageComponent","optionsComponent","PowerSelectOptionsComponent","groupComponent","PowerSelectGroupComponent","handleOpen","e","onOpen","focusInput","KeyboardEvent","type","key","preventDefault","_resetHighlighted","n","action","handleClose","onClose","handleInput","target","term","value","correctedTerm","onInput","handleKeydown","onKeydown","isOpen","stopPropagation","indexOf","actions","close","open","_routeKeydown","handleTriggerKeydown","stopImmediatePropagation","ctrlKey","metaKey","test","triggerTypingTask","perform","_handleKeySpace","event","detail","trigger","getTriggerElement","focus","handleFocus","isDestroying","Promise","resolve","_updateIsActive","input","querySelector","onFocus","handleBlur","onBlur","_updateHighlighted","opt","disabled","isEqual","selection","closeOnSelect","document","root","triggerElement","getRootNode","ShadowRoot","optionsList","uniqueId","index","indexOfOption","optionElement","optionTopScroll","offsetTop","optionBottomScroll","offsetHeight","scrollTop","updateOptions","modifier","__updateOptions","eager","updateSelected","__updateSelected","updateRegisterAPI","publicAPI","__registerAPI","updatePerformSearch","__performSearch","currentOptionsPromise","resolvedOptions","catch","currentSelectedPromise","resolvedSelected","_","registerAPI","searchResult","Error","newSelection","idx","splice","push","_handleKeyUpDown","_handleKeyEnter","_handleKeyTab","_handleKeyESC","includes","nodeName","step","newHighlighted","advanceSelectableOption","defHighlighted","defaultHighlighted","skipDisabled","optionMatcher","filterOptions","isActive","findWithOffset","offset","typeAheadOptionMatcher","defaultTypeAheadMatcher","findOptionWithOffset","dropdown","Object","assign","_buildTask","context","generator","searchStartOffset","repeatingChar","_repeatingChar","c","_expirableSearchText","match","timeout","restartable","setComponentTemplate","precompileTemplate","strictMode","scope","or","BasicDropdown","concat","and","not","on","notEq"],"mappings":"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"}