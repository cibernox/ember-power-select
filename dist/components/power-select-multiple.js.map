{"version":3,"file":"power-select-multiple.js","sources":["../../src/components/power-select-multiple.ts"],"sourcesContent":["import Component from '@glimmer/component';\nimport { action } from '@ember/object';\nimport { isEqual } from '@ember/utils';\nimport type {\n  PowerSelectArgs,\n  PowerSelectSignature,\n  Select,\n} from './power-select';\nimport { deprecate } from '@ember/debug';\nimport type Owner from '@ember/owner';\n\n// eslint-disable-next-line @typescript-eslint/no-empty-object-type\ninterface PowerSelectMultipleSignature extends PowerSelectSignature {\n  // any extra property for multiple selects?\n}\n\nexport default class PowerSelectMultipleComponent extends Component<PowerSelectMultipleSignature> {\n  constructor(owner: Owner, args: PowerSelectArgs) {\n    super(owner, args);\n    deprecate(\n      'You are using the `<PowerSelectMultiple>` component. Replace all usages with `<PowerSelect>` and pass `@multiple={{true}}` as a parameter to achieve the same behavior. If you have used the ID `#ember-power-select-trigger-multiple-input-{uniqueId}` to access the search field, update your `querySelector` to use `#ember-power-select-trigger-input-{uniqueId}` instead. If you have a custom multiple trigger or input component, you also need to move them to `<PowerSelect::Trigger>` / `<PowerSelect::Input>`.',\n      false,\n      {\n        for: 'ember-power-select',\n        id: 'ember-power-select.deprecate-power-select-multiple',\n        since: {\n          enabled: '8.11',\n          available: '8.11',\n        },\n        until: '9.0.0',\n      },\n    );\n  }\n\n  get computedTabIndex() {\n    if (this.args.triggerComponent === undefined && this.args.searchEnabled) {\n      return '-1';\n    } else {\n      return this.args.tabindex || '0';\n    }\n  }\n\n  // Actions\n  @action\n  handleOpen(select: Select, e: Event): false | void {\n    if (this.args.onOpen && this.args.onOpen(select, e) === false) {\n      return false;\n    }\n    this.focusInput(select);\n  }\n\n  @action\n  handleFocus(select: Select, e: FocusEvent): void {\n    if (this.args.onFocus) {\n      this.args.onFocus(select, e);\n    }\n    this.focusInput(select);\n  }\n\n  @action\n  handleKeydown(select: Select, e: KeyboardEvent): false | void {\n    if (this.args.onKeydown && this.args.onKeydown(select, e) === false) {\n      e.stopPropagation();\n      return false;\n    }\n    if (e.keyCode === 13 && select.isOpen) {\n      e.stopPropagation();\n      if (select.highlighted !== undefined) {\n        if (\n          !select.selected ||\n          select.selected.indexOf(select.highlighted) === -1\n        ) {\n          select.actions.choose(select.highlighted, e);\n          return false;\n        } else {\n          select.actions.close(e);\n          return false;\n        }\n      } else {\n        select.actions.close(e);\n        return false;\n      }\n    }\n  }\n\n  defaultBuildSelection(option: any, select: Select) {\n    const newSelection = Array.isArray(select.selected)\n      ? select.selected.slice(0)\n      : [];\n    let idx = -1;\n    for (let i = 0; i < newSelection.length; i++) {\n      if (isEqual(newSelection[i], option)) {\n        idx = i;\n        break;\n      }\n    }\n    if (idx > -1) {\n      newSelection.splice(idx, 1);\n    } else {\n      newSelection.push(option);\n    }\n    return newSelection;\n  }\n\n  focusInput(select: Select) {\n    if (select) {\n      const triggerElement = select.actions.getTriggerElement();\n      let root: Document | HTMLElement;\n\n      if (\n        triggerElement &&\n        triggerElement.getRootNode() instanceof ShadowRoot\n      ) {\n        root = triggerElement.getRootNode() as HTMLElement;\n      } else {\n        root = document;\n      }\n\n      const input = root.querySelector(\n        `#ember-power-select-trigger-multiple-input-${select.uniqueId}`,\n      ) as HTMLElement;\n\n      if (input) {\n        input.focus();\n      }\n    }\n  }\n}\n"],"names":["PowerSelectMultipleComponent","Component","constructor","owner","args","deprecate","for","id","since","enabled","available","until","computedTabIndex","triggerComponent","undefined","searchEnabled","tabindex","handleOpen","select","e","onOpen","focusInput","n","prototype","action","handleFocus","onFocus","handleKeydown","onKeydown","stopPropagation","keyCode","isOpen","highlighted","selected","indexOf","actions","choose","close","defaultBuildSelection","option","newSelection","Array","isArray","slice","idx","i","length","isEqual","splice","push","triggerElement","getTriggerElement","root","getRootNode","ShadowRoot","document","input","querySelector","uniqueId","focus","setComponentTemplate","TEMPLATE"],"mappings":"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"}