{"version":3,"file":"before-options.js","sources":["../../../src/components/power-select/before-options.ts"],"sourcesContent":["import Component from '@glimmer/component';\nimport { action } from '@ember/object';\nimport { modifier } from 'ember-modifier';\nimport type { Select, TSearchFieldPosition } from '../power-select';\nimport { deprecate } from '@ember/debug';\nimport { task, timeout } from 'ember-concurrency';\n\ninterface PowerSelectBeforeOptionsSignature {\n  Element: HTMLElement;\n  Args: {\n    select: Select;\n    searchEnabled: boolean;\n    ariaLabel?: string;\n    ariaLabelledBy?: string;\n    ariaDescribedBy?: string;\n    role?: string;\n    searchPlaceholder?: string;\n    searchFieldPosition?: TSearchFieldPosition;\n    ariaActiveDescendant?: string;\n    listboxId?: string;\n    onKeydown: (e: KeyboardEvent) => false | void;\n    onBlur: (e: FocusEvent) => void;\n    onFocus: (e: FocusEvent) => void;\n    onInput: (e: InputEvent) => boolean;\n    autofocus?: boolean;\n  };\n}\n\nexport default class PowerSelectBeforeOptionsComponent extends Component<PowerSelectBeforeOptionsSignature> {\n  didSetup: boolean = false;\n\n  @action\n  clearSearch(): void {\n    deprecate(\n      'You are using power-select before-option component with ember/render-modifier. Replace {{will-destroy this.clearSearch}} with {{this.setupInput}}.',\n      false,\n      {\n        for: 'ember-power-select',\n        id: 'ember-power-select.no-at-ember-render-modifiers',\n        since: {\n          enabled: '8.1',\n          available: '8.1',\n        },\n        until: '9.0.0',\n      },\n    );\n\n    this.args.select.actions?.search('');\n  }\n\n  @action\n  handleKeydown(e: KeyboardEvent): false | void {\n    if (this.args.onKeydown(e) === false) {\n      return false;\n    }\n    if (e.keyCode === 13) {\n      this.args.select.actions.close(e);\n    }\n  }\n\n  @action\n  handleInput(event: Event): false | void {\n    const e = event as InputEvent;\n    if (this.args.onInput(e) === false) {\n      return false;\n    }\n  }\n\n  @action\n  focusInput(el: HTMLElement) {\n    deprecate(\n      'You are using power-select before-option component with ember/render-modifier. Replace {{did-insert this.focusInput}} with {{this.setupInput}}.',\n      false,\n      {\n        for: 'ember-power-select',\n        id: 'ember-power-select.no-at-ember-render-modifiers',\n        since: {\n          enabled: '8.1',\n          available: '8.1',\n        },\n        until: '9.0.0',\n      },\n    );\n\n    this._focusInput(el);\n  }\n\n  setupInput = modifier(\n    (el: HTMLElement) => {\n      if (this.didSetup) {\n        return;\n      }\n\n      this.didSetup = true;\n\n      this._focusInput(el);\n\n      return () => {\n        this.args.select.actions?.search('');\n      };\n    },\n    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n    // @ts-ignore\n    { eager: false },\n  );\n\n  private _focusInput(el: HTMLElement) {\n    this.focusLaterTask.perform(el);\n  }\n\n  private focusLaterTask = task(async (el: HTMLElement) => {\n    await timeout(0);\n    if (this.args.autofocus !== false) {\n      el.focus();\n    }\n  });\n}\n"],"names":["PowerSelectBeforeOptionsComponent","Component","didSetup","clearSearch","deprecate","for","id","since","enabled","available","until","args","select","actions","search","n","prototype","action","handleKeydown","e","onKeydown","keyCode","close","handleInput","event","onInput","focusInput","el","_focusInput","setupInput","modifier","eager","focusLaterTask","perform","_buildTask","context","generator","timeout","autofocus","focus","setComponentTemplate","TEMPLATE"],"mappings":"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"}