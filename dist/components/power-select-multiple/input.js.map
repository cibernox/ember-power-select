{"version":3,"file":"input.js","sources":["../../../src/components/power-select-multiple/input.ts"],"sourcesContent":["import Component from '@glimmer/component';\nimport { action } from '@ember/object';\nimport { get } from '@ember/object';\nimport { assert, deprecate } from '@ember/debug';\nimport { isBlank } from '@ember/utils';\nimport type { Select } from '../power-select';\nimport type Owner from '@ember/owner';\n\ninterface PowerSelectMultipleInputSignature {\n  Element: HTMLElement;\n  Args: {\n    select: Select;\n    placeholder?: string;\n    searchField: string;\n    tabindex?: string;\n    listboxId?: string;\n    ariaLabel?: string;\n    ariaActiveDescendant?: string;\n    ariaLabelledBy?: string;\n    ariaDescribedBy?: string;\n    role?: string;\n    placeholderComponent?: string;\n    isDefaultPlaceholder?: boolean;\n    onInput?: (e: InputEvent) => boolean;\n    onKeydown?: (e: KeyboardEvent) => boolean;\n    onFocus: (e: FocusEvent) => void;\n    onBlur: (e: FocusEvent) => void;\n    buildSelection: (lastSelection: any, select: Select) => any[];\n  };\n}\n\nexport default class PowerSelectMultipleInputComponent extends Component<PowerSelectMultipleInputSignature> {\n  constructor(owner: Owner, args: PowerSelectMultipleInputSignature['Args']) {\n    super(owner, args);\n    deprecate(\n      'You are using the `<PowerSelectMultiple::Input>` component. Replace all usages with the `<PowerSelect::Input>` component.',\n      false,\n      {\n        for: 'ember-power-select',\n        id: 'ember-power-select.deprecate-power-select-multiple-input',\n        since: {\n          enabled: '8.11',\n          available: '8.11',\n        },\n        until: '9.0.0',\n      },\n    );\n  }\n\n  get maybePlaceholder() {\n    if (!this.args.isDefaultPlaceholder) {\n      return undefined;\n    }\n    return !this.args.select.selected || this.args.select.selected.length === 0\n      ? this.args.placeholder || ''\n      : '';\n  }\n\n  @action\n  handleInput(event: Event): void {\n    const e = event as InputEvent;\n    if (this.args.onInput && this.args.onInput(e) === false) {\n      return;\n    }\n    this.args.select.actions.open(e);\n  }\n\n  @action\n  handleKeydown(event: Event): false | void {\n    const e = event as KeyboardEvent;\n    if (e.target === null) return;\n    if (this.args.onKeydown && this.args.onKeydown(e) === false) {\n      e.stopPropagation();\n      return false;\n    }\n    if (e.keyCode === 8) {\n      e.stopPropagation();\n      if (isBlank((e.target as HTMLInputElement).value)) {\n        const lastSelection =\n          this.args.select.selected &&\n          this.args.select.selected[this.args.select.selected.length - 1];\n        if (lastSelection) {\n          this.args.select.actions.select(\n            this.args.buildSelection(lastSelection, this.args.select),\n            e,\n          );\n          if (typeof lastSelection === 'string') {\n            this.args.select.actions.search(lastSelection);\n          } else {\n            assert(\n              '`<PowerSelectMultiple>` requires a `@searchField` when the options are not strings to remove options using backspace',\n              this.args.searchField,\n            );\n            this.args.select.actions.search(\n              get(lastSelection, this.args.searchField) || '',\n            );\n          }\n          this.args.select.actions.open(e);\n        }\n      }\n    } else if ((e.keyCode >= 48 && e.keyCode <= 90) || e.keyCode === 32) {\n      // Keys 0-9, a-z or SPACE\n      e.stopPropagation();\n    }\n  }\n}\n"],"names":["PowerSelectMultipleInputComponent","Component","constructor","owner","args","deprecate","for","id","since","enabled","available","until","maybePlaceholder","isDefaultPlaceholder","undefined","select","selected","length","placeholder","handleInput","event","e","onInput","actions","open","n","prototype","action","handleKeydown","target","onKeydown","stopPropagation","keyCode","isBlank","value","lastSelection","buildSelection","search","assert","searchField","get","setComponentTemplate","TEMPLATE"],"mappings":"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"}