{"version":3,"file":"test-support.js","sources":["../src/test-support.ts"],"sourcesContent":["import { click, fillIn, settled } from '@ember/test-helpers';\n\nasync function openIfClosedAndGetContentId(trigger: HTMLElement) {\n  const contentId = `ember-basic-dropdown-content-${trigger\n    .getAttribute('data-ebd-id')\n    ?.replace('-trigger', '')}`;\n  const content = contentId\n    ? document.querySelector(`#${contentId}`)\n    : undefined;\n  // If the dropdown is closed, open it\n  if (\n    !content ||\n    content.classList.contains('ember-basic-dropdown-content-placeholder')\n  ) {\n    await click(trigger);\n  }\n  return contentId;\n}\n\nexport async function selectChoose(\n  cssPathOrTrigger: string | HTMLElement,\n  valueOrSelector: string,\n  optionIndex?: number,\n) {\n  let trigger: HTMLElement | null = null;\n  let target: HTMLElement | undefined;\n  if (cssPathOrTrigger instanceof HTMLElement) {\n    if (cssPathOrTrigger.classList.contains('ember-power-select-trigger')) {\n      trigger = cssPathOrTrigger;\n    } else {\n      trigger = cssPathOrTrigger.querySelector('.ember-power-select-trigger');\n    }\n  } else {\n    trigger = document.querySelector(\n      `${cssPathOrTrigger} .ember-power-select-trigger`,\n    );\n\n    if (!trigger) {\n      trigger = document.querySelector(cssPathOrTrigger);\n    }\n  }\n\n  if (!trigger) {\n    throw new Error(\n      `You called \"selectChoose('${cssPathOrTrigger}', '${valueOrSelector}')\" but no select was found using selector \"${cssPathOrTrigger}\"`,\n    );\n  }\n\n  trigger.scrollIntoView();\n\n  const contentId = await openIfClosedAndGetContentId(trigger);\n  // Select the option with the given text\n  const options = document.querySelectorAll<HTMLElement>(\n    `#${contentId} .ember-power-select-option`,\n  );\n  let potentialTargets = Array.from(options).filter(\n    (opt) => (opt.textContent ?? '').indexOf(valueOrSelector) > -1,\n  );\n  if (potentialTargets.length === 0) {\n    potentialTargets = Array.from(\n      document.querySelectorAll(`#${contentId} ${valueOrSelector}`),\n    );\n  }\n  if (potentialTargets.length > 1) {\n    const filteredTargets = potentialTargets.filter(\n      (t) => t.textContent?.trim() === valueOrSelector,\n    );\n    if (optionIndex === undefined) {\n      target = filteredTargets[0] ?? potentialTargets[0];\n    } else {\n      target = filteredTargets[optionIndex] ?? potentialTargets[optionIndex];\n    }\n  } else {\n    target = potentialTargets[0];\n  }\n  if (!target) {\n    throw new Error(\n      `You called \"selectChoose('${cssPathOrTrigger}', '${valueOrSelector}')\" but \"${valueOrSelector}\" didn't match any option`,\n    );\n  }\n  await click(target);\n  return settled();\n}\n\nexport async function selectSearch(\n  cssPathOrTrigger: string | HTMLElement,\n  value: string,\n) {\n  let trigger: HTMLElement | null;\n  if (cssPathOrTrigger instanceof HTMLElement) {\n    trigger = cssPathOrTrigger;\n  } else {\n    let triggerPath = `${cssPathOrTrigger} .ember-power-select-trigger`;\n    trigger = document.querySelector(triggerPath);\n    if (!trigger) {\n      triggerPath = cssPathOrTrigger;\n      trigger = document.querySelector(triggerPath);\n    }\n\n    if (!trigger) {\n      throw new Error(\n        `You called \"selectSearch('${cssPathOrTrigger}', '${value}')\" but no select was found using selector \"${cssPathOrTrigger}\"`,\n      );\n    }\n  }\n\n  trigger.scrollIntoView();\n\n  const isMultipleSelect = !!trigger.querySelector(\n    '.ember-power-select-trigger-multiple-input',\n  );\n\n  const contentId = await openIfClosedAndGetContentId(trigger);\n  const isDefaultSingleSelect = !!document.querySelector(\n    '.ember-power-select-search-input',\n  );\n\n  if (isMultipleSelect) {\n    const multiSelectTrigger = trigger.querySelector(\n      '.ember-power-select-trigger-multiple-input',\n    );\n    if (multiSelectTrigger) {\n      await fillIn(multiSelectTrigger, value);\n    }\n  } else if (isDefaultSingleSelect) {\n    await fillIn('.ember-power-select-search-input', value);\n  } else {\n    // It's probably a customized version\n    const triggerInput = trigger.querySelector(\n      '.ember-power-select-trigger input[type=search]',\n    );\n    if (triggerInput) {\n      await fillIn(triggerInput, value);\n    } else {\n      await fillIn(\n        `#${contentId} .ember-power-select-search-input[type=search]`,\n        'input',\n      );\n    }\n  }\n  return settled();\n}\n\nexport async function removeMultipleOption(cssPath: string, value: string) {\n  let elem: HTMLElement | null = null;\n  const items = document.querySelectorAll(\n    `${cssPath} .ember-power-select-multiple-options > li`,\n  );\n  const item = Array.from(items).find(\n    (el) => (el.textContent ?? '').indexOf(value) > -1,\n  );\n  if (item) {\n    elem = item.querySelector('.ember-power-select-multiple-remove-btn');\n  }\n\n  if (!elem) {\n    throw new Error(\n      `You called \"removeMultipleOption('${cssPath}', '${value}')\" but no remove button was found using selector \"${cssPath}\" for value \"${value}\"`,\n    );\n  }\n\n  await click(elem);\n  return settled();\n}\n\nexport async function clearSelected(cssPath: string) {\n  const elem = document.querySelector(\n    `${cssPath} .ember-power-select-clear-btn`,\n  );\n\n  if (!elem) {\n    throw new Error(\n      `You called \"clearSelected('${cssPath}')\" but no clear button was found using selector \"${cssPath}\"`,\n    );\n  }\n\n  await click(elem);\n  return settled();\n}\n\n/* *\n * @param {String} selector CSS3 selector of the elements to check the content\n * @returns {Array} returns all the elements present in the dropdown\n * */\nexport async function getDropdownItems(cssPathOrTrigger: string | HTMLElement) {\n  let trigger: HTMLElement | null = null;\n\n  if (cssPathOrTrigger instanceof HTMLElement) {\n    if (cssPathOrTrigger.classList.contains('ember-power-select-trigger')) {\n      trigger = cssPathOrTrigger;\n    } else {\n      trigger = cssPathOrTrigger.querySelector('.ember-power-select-trigger');\n    }\n  } else {\n    trigger = document.querySelector(\n      `${cssPathOrTrigger} .ember-power-select-trigger`,\n    );\n\n    if (!trigger) {\n      trigger = document.querySelector(cssPathOrTrigger);\n    }\n  }\n\n  if (!trigger) {\n    throw new Error(\n      `You called \"getDropdownItems('${cssPathOrTrigger}'\" but no select was found using selector \"${cssPathOrTrigger}\"`,\n    );\n  }\n\n  trigger.scrollIntoView();\n\n  const contentId = await openIfClosedAndGetContentId(trigger);\n  // Select the option with the given selector\n  const rawOptions = document.querySelectorAll(\n    `#${contentId} .ember-power-select-option`,\n  );\n  return Array.from(rawOptions).map((opt) => opt.textContent?.trim());\n}\n"],"names":["openIfClosedAndGetContentId","trigger","contentId","getAttribute","replace","content","document","querySelector","undefined","classList","contains","click","selectChoose","cssPathOrTrigger","valueOrSelector","optionIndex","target","HTMLElement","Error","scrollIntoView","options","querySelectorAll","potentialTargets","Array","from","filter","opt","textContent","indexOf","length","filteredTargets","t","trim","settled","selectSearch","value","triggerPath","isMultipleSelect","isDefaultSingleSelect","multiSelectTrigger","fillIn","triggerInput","removeMultipleOption","cssPath","elem","items","item","find","el","clearSelected","getDropdownItems","rawOptions","map"],"mappings":"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"}