{"version":3,"file":"test-support.js","sources":["../src/test-support.ts"],"sourcesContent":["import { click, fillIn, settled } from '@ember/test-helpers';\n\nasync function openIfClosedAndGetContentId(trigger: HTMLElement) {\n  const contentId = `ember-basic-dropdown-content-${trigger\n    .getAttribute('data-ebd-id')\n    ?.replace('-trigger', '')}`;\n  const content = contentId\n    ? (trigger.getRootNode() as HTMLElement).querySelector(`#${contentId}`)\n    : undefined;\n  // If the dropdown is closed, open it\n  if (\n    !content ||\n    content.classList.contains('ember-basic-dropdown-content-placeholder')\n  ) {\n    await click(trigger);\n  }\n  return contentId;\n}\n\nexport async function selectChoose(\n  cssPathOrTrigger: string | HTMLElement,\n  valueOrSelector: string,\n  optionIndex?: number,\n) {\n  let trigger: HTMLElement | null = null;\n  let target: HTMLElement | undefined;\n  if (cssPathOrTrigger instanceof HTMLElement) {\n    if (cssPathOrTrigger.classList.contains('ember-power-select-trigger')) {\n      trigger = cssPathOrTrigger;\n    } else {\n      trigger = cssPathOrTrigger.querySelector('.ember-power-select-trigger');\n    }\n  } else {\n    trigger = document.querySelector(\n      `${cssPathOrTrigger} .ember-power-select-trigger`,\n    );\n\n    if (!trigger) {\n      trigger = document.querySelector(cssPathOrTrigger);\n    }\n  }\n\n  if (!trigger) {\n    throw new Error(\n      `You called \"selectChoose\" with '${valueOrSelector}' but no select was found`,\n    );\n  }\n\n  trigger.scrollIntoView();\n\n  const contentId = await openIfClosedAndGetContentId(trigger);\n  const rootElement = trigger.getRootNode() as HTMLElement;\n  // Select the option with the given text\n  const options = rootElement.querySelectorAll<HTMLElement>(\n    `#${contentId} .ember-power-select-option`,\n  );\n  let potentialTargets = Array.from(options).filter(\n    (opt) => (opt.textContent ?? '').indexOf(valueOrSelector) > -1,\n  );\n  if (potentialTargets.length === 0) {\n    potentialTargets = Array.from(\n      rootElement.querySelectorAll(`#${contentId} ${valueOrSelector}`),\n    );\n  }\n  if (potentialTargets.length > 1) {\n    const filteredTargets = potentialTargets.filter(\n      (t) => t.textContent?.trim() === valueOrSelector,\n    );\n    if (optionIndex === undefined) {\n      target = filteredTargets[0] ?? potentialTargets[0];\n    } else {\n      target = filteredTargets[optionIndex] ?? potentialTargets[optionIndex];\n    }\n  } else {\n    target = potentialTargets[0];\n  }\n  if (!target) {\n    throw new Error(\n      `You called \"selectChoose\" with '${valueOrSelector}' but \"${valueOrSelector}\" didn't match any option`,\n    );\n  }\n  await click(target);\n  return settled();\n}\n\nexport async function selectSearch(\n  cssPathOrTrigger: string | HTMLElement,\n  value: string,\n) {\n  let trigger: HTMLElement | null;\n  if (cssPathOrTrigger instanceof HTMLElement) {\n    if (cssPathOrTrigger.classList.contains('ember-power-select-trigger')) {\n      trigger = cssPathOrTrigger;\n    } else {\n      trigger = cssPathOrTrigger.querySelector('.ember-power-select-trigger');\n    }\n  } else {\n    let triggerPath = `${cssPathOrTrigger} .ember-power-select-trigger`;\n    trigger = document.querySelector(triggerPath);\n    if (!trigger) {\n      triggerPath = cssPathOrTrigger;\n      trigger = document.querySelector(triggerPath);\n    }\n  }\n\n  if (!trigger) {\n    throw new Error(\n      `You called \"selectSearch\" with '${value}' but no select was found`,\n    );\n  }\n\n  trigger.scrollIntoView();\n\n  const isMultipleSelect = !!trigger.querySelector(\n    '.ember-power-select-trigger-multiple-input',\n  );\n\n  const rootElement = trigger.getRootNode() as HTMLElement;\n\n  const contentId = await openIfClosedAndGetContentId(trigger);\n  const isDefaultSingleSelect = !!rootElement.querySelector(\n    '.ember-power-select-search-input',\n  );\n\n  if (isMultipleSelect) {\n    const multiSelectTrigger = trigger.querySelector(\n      '.ember-power-select-trigger-multiple-input',\n    );\n    if (multiSelectTrigger) {\n      await fillIn(multiSelectTrigger, value);\n    }\n  } else if (isDefaultSingleSelect) {\n    await fillIn(\n      rootElement.querySelector(\n        '.ember-power-select-search-input',\n      ) as HTMLElement,\n      value,\n    );\n  } else {\n    // It's probably a customized version\n    const triggerInput = trigger.querySelector(\n      '.ember-power-select-trigger input[type=search]',\n    );\n    if (triggerInput) {\n      await fillIn(triggerInput, value);\n    } else {\n      await fillIn(\n        `#${contentId} .ember-power-select-search-input[type=search]`,\n        'input',\n      );\n    }\n  }\n  return settled();\n}\n\nexport async function removeMultipleOption(\n  cssPath: string,\n  value: string,\n  rootElement?: HTMLElement,\n) {\n  let elem: HTMLElement | null = null;\n  const items = (rootElement || document).querySelectorAll(\n    `${cssPath} .ember-power-select-multiple-options > li`,\n  );\n  const item = Array.from(items).find(\n    (el) => (el.textContent ?? '').indexOf(value) > -1,\n  );\n  if (item) {\n    elem = item.querySelector('.ember-power-select-multiple-remove-btn');\n  }\n\n  if (!elem) {\n    throw new Error(\n      `You called \"removeMultipleOption('${cssPath}', '${value}')\" but no remove button was found using selector \"${cssPath}\" for value \"${value}\"`,\n    );\n  }\n\n  await click(elem);\n  return settled();\n}\n\nexport async function clearSelected(\n  cssPath: string,\n  rootElement?: HTMLElement,\n) {\n  const elem = (rootElement || document).querySelector(\n    `${cssPath} .ember-power-select-clear-btn`,\n  );\n\n  if (!elem) {\n    throw new Error(\n      `You called \"clearSelected('${cssPath}')\" but no clear button was found using selector \"${cssPath}\"`,\n    );\n  }\n\n  await click(elem);\n  return settled();\n}\n\n/* *\n * @param {String} selector CSS3 selector of the elements to check the content\n * @returns {Array} returns all the elements present in the dropdown\n * */\nexport async function getDropdownItems(cssPathOrTrigger: string | HTMLElement) {\n  let trigger: HTMLElement | null = null;\n\n  if (cssPathOrTrigger instanceof HTMLElement) {\n    if (cssPathOrTrigger.classList.contains('ember-power-select-trigger')) {\n      trigger = cssPathOrTrigger;\n    } else {\n      trigger = cssPathOrTrigger.querySelector('.ember-power-select-trigger');\n    }\n  } else {\n    trigger = document.querySelector(\n      `${cssPathOrTrigger} .ember-power-select-trigger`,\n    );\n\n    if (!trigger) {\n      trigger = document.querySelector(cssPathOrTrigger);\n    }\n  }\n\n  if (!trigger) {\n    throw new Error(`You called \"getDropdownItems\" but no select was found`);\n  }\n\n  trigger.scrollIntoView();\n\n  const contentId = await openIfClosedAndGetContentId(trigger);\n  const rootElement = trigger.getRootNode() as HTMLElement;\n  // Select the option with the given selector\n  const rawOptions = rootElement.querySelectorAll(\n    `#${contentId} .ember-power-select-option`,\n  );\n  return Array.from(rawOptions).map((opt) => opt.textContent?.trim());\n}\n"],"names":["openIfClosedAndGetContentId","trigger","contentId","getAttribute","replace","content","getRootNode","querySelector","undefined","classList","contains","click","selectChoose","cssPathOrTrigger","valueOrSelector","optionIndex","target","HTMLElement","document","Error","scrollIntoView","rootElement","options","querySelectorAll","potentialTargets","Array","from","filter","opt","textContent","indexOf","length","filteredTargets","t","trim","settled","selectSearch","value","triggerPath","isMultipleSelect","isDefaultSingleSelect","multiSelectTrigger","fillIn","triggerInput","removeMultipleOption","cssPath","elem","items","item","find","el","clearSelected","getDropdownItems","rawOptions","map"],"mappings":"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"}